<!DOCTYPE html>
<html>
<head>
    <title>Get Week Number / Data Matrix Generator</title>
    <link rel=icon type=image/x-icon
          href="C:\Users\astafieni\OneDrive - Louis Vuitton Malletier\Code generator LV\schedule.png">
    <script src=https://cdn.jsdelivr.net/npm/bwip-js@3.0.0/dist/bwip-js.min.js></script>
	<div id="copyright">
    &copy; Nikita Astafiev. All rights reserved V.1.0
	</div>
<style>
        body {
		/* Keep your existing body styles and add these */
		background-color: #f9f7f4;
		background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23c8b897' fill-opacity='0.15'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
		background-attachment: fixed;
}
		
		body {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding-left: 20px;
            padding-top: 60px 60px;
        }

        button {
            font-size: 24px;
            padding: 20px 40px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            margin-bottom: 20px;
            margin-top: 10px;
        }

        button:hover {
            background-color: #3e8e41;
        }

        .input-group {
            margin-bottom: 10px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            text-align: left;
            width: 100%;
        }

        input[type=text],
        input[type=number] {
            padding: 8px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 200px;
            box-sizing: border-box;
        }

        #generatedCode {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            text-align: left;
        }

        .hidden-label {
            display: none;
        }

        .hidden {
            display: none;
        }

        .serial-container {
            display: flex;
            align-items: center;
            width: 100%;
        }

        .serial-container .input-group {
            width: auto;
            flex-grow: 1;
            margin-bottom: 0;
        }

        .serial-container #generatedCode {
            margin-left: -1000px;
            margin-top: 0;
            flex-grow: 1;
            text-align: left;
        }
        
        #barcodeImage {
            margin-top: -60px;
            margin-left: -350px;
            text-align: center;
        }

        #barcodeImage canvas {
            border: 1px solid #ccc;
            padding: 10px;
            background-color: white;
        }
        
        .utility-button {
            font-size: 16px;
            padding: 8px 16px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .utility-button:hover {
            background-color: #0056b3;
        }
		
		#productImageSection {
			position: absolute;
			/*left: 90%; /* Changed from 50% to move it left */*/
			transform: translateX(-50%);
			margin-left: -450px;
			text-align: center;
			z-index: 10;
			
}


		#productImage {
			max-width: 300px;
			box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

		/* Add this to create space at the bottom of the page for the image */
			body::after {
			content: "";
			display: block;
			height: 400px; /* Adjust based on your image size */
			width: 100%;
}

		button[onclick="focusSerial()"] {
			position: relative;
			z-index: 100;
			padding: 8px 16px;
			margin-left: 10px;
			cursor: pointer;
			background-color: #007bff;
			color: white;
			border: none;
			border-radius: 4px;
			min-width: 80px;
			min-height: 35px;
			font-size: 14px;
			display: inline-block; /* Ensure proper block rendering */
			pointer-events: auto; /* Force pointer events to be active */
}

#copyright {
    position: fixed;
    bottom: 10px;
    right: 10px;
    font-size: 12px;
    color: #666;
    padding: 5px;
    background-color: rgba(255, 255, 255, 0.7);
    border-radius: 3px;
    z-index: 1000;
}
	
    </style>
</head>
<body>

<button onclick="getWeekNumber()">Get Week Number</button>

<h2>Data Matrix Code Generator</h2>

<div>
    <button class="utility-button" onclick="resetToDefaults()">Reset to Default Values</button>
    <button class="utility-button" onclick="clearAllFields()">Clear All Fields</button>
</div>

<div class="serial-container">
    <div class="input-group">
        <label for="serial" class="hidden-label">Serial (13-14 chars):</label>
        <input type="text" id="serial" name="serial" maxlength="14">
		<button type="button" class="utility-button" onclick="focusSerial()">Edit Serial</button>
    </div>
    <div id="generatedCode">
  <div id="codeTitle" style="font-weight: bold; color: blue; font-size: 20px;">2D Data Matrix code PCE:</div>
  <div style="display: flex; align-items: center;">
  <div id="codeResult" style="margin-right: 10px;"></div>
    <button id="copyButton" class="utility-button" style="margin: 0; padding: 4px 8px; font-size: 12px;">Copy</button>
  </div>
  <div id="barcodeImage"></div>
</div>
</div>
</div>
</div>

</div>

<div class="input-group">
    <label for="shortSku">ShortSKU (6 chars):</label>
    <input type="text" id="shortSku" name="shortSku" maxlength="6">
</div>

<div class="input-group">
    <label for="quantity">Quantity (4 digits):</label>
    <input type="number" id="quantity" name="quantity" min="0" max="9999">
</div>

<div class="input-group">
    <label for="madeIn">Made IN (2 chars):</label>
    <input type="text" id="madeIn" name="madeIn" maxlength="2">
</div>

<div class="input-group">
    <label for="supplierId">Supplier ID (3 chars):</label>
    <input type="text" id="supplierId" name="supplierId" maxlength="3">
</div>

<div class="input-group">
    <label for="batch">Batch (3-17 chars):</label>
    <input type="text" id="batch" name="batch" minlength="3" maxlength="17">
</div>

<div class="input-group">
    <label for="originPref">Origin Pref (3-17 chars):</label>
    <input type="text" id="originPref" name="originPref" minlength="3" maxlength="17">
</div>

<button onclick="generateCode()">Generate Code</button>

<div id="productImageSection" style="display: none; position: absolute; left: 50%; transform: translateX(-50%); margin-top: 10px; text-align: center;font-size: 20px;">
    <h3 style="color: blue; margin-left: -150px;margin-bottom: 10px;">Product Image</h3>
    <a id="productImageLink" href="#" target="_blank">
        <img id="productImage" src="" alt="Product Image" style="max-width: 300px; margin-left: 150px; border: 1px solid #ccc; padding: 80px;">
    </a>
</div>


<script>
    const _0x3978d4=_0x3ff7;(function(_0x5191f7,_0x27ccc3){const _0x277bb2=_0x3ff7,_0x340bbf=_0x5191f7();while(!![]){try{const _0xbcf17c=-parseInt(_0x277bb2(0x1ad))/0x1+parseInt(_0x277bb2(0x19f))/0x2*(parseInt(_0x277bb2(0x17c))/0x3)+parseInt(_0x277bb2(0x16e))/0x4*(-parseInt(_0x277bb2(0x16a))/0x5)+parseInt(_0x277bb2(0x196))/0x6*(parseInt(_0x277bb2(0x17b))/0x7)+parseInt(_0x277bb2(0x19a))/0x8*(-parseInt(_0x277bb2(0x194))/0x9)+-parseInt(_0x277bb2(0x191))/0xa+parseInt(_0x277bb2(0x1a5))/0xb;if(_0xbcf17c===_0x27ccc3)break;else _0x340bbf['push'](_0x340bbf['shift']());}catch(_0x26c985){_0x340bbf['push'](_0x340bbf['shift']());}}}(_0x1efd,0x79997),Date[_0x3978d4(0x193)][_0x3978d4(0x19b)]=function(){const _0x15fe1f=_0x3978d4;var _0x150ba2=new Date(this[_0x15fe1f(0x19c)]()),_0x55978e=(this[_0x15fe1f(0x173)]()+0x6)%0x7;_0x150ba2['setDate'](_0x150ba2[_0x15fe1f(0x1b2)]()-_0x55978e+0x3);var _0x29e2c6=_0x150ba2[_0x15fe1f(0x19c)]();return _0x150ba2[_0x15fe1f(0x190)](0x0,0x1),_0x150ba2[_0x15fe1f(0x173)]()!=0x4&&_0x150ba2['setMonth'](0x0,0x1+(0x4-_0x150ba2['getDay']()+0x7)%0x7),0x1+Math[_0x15fe1f(0x170)]((_0x29e2c6-_0x150ba2)/0x240c8400);});function getWeekNumber(){const _0x3931d1=_0x3978d4;var _0x1e232e=new Date();alert(_0x1e232e[_0x3931d1(0x19b)]());}function _0x3ff7(_0x84e640,_0x63b206){const _0x1efd41=_0x1efd();return _0x3ff7=function(_0x3ff795,_0x434589){_0x3ff795=_0x3ff795-0x164;let _0x46836a=_0x1efd41[_0x3ff795];return _0x46836a;},_0x3ff7(_0x84e640,_0x63b206);}let currentShortSku='';function updateProductImage(){const _0x5d0020=_0x3978d4,_0x556cac=document['getElementById'](_0x5d0020(0x195))[_0x5d0020(0x178)],_0x45b997=document[_0x5d0020(0x165)]('productImageSection'),_0x46eace=Math[_0x5d0020(0x16f)]()<0.2;if(_0x46eace){const _0x3080ab='PayPal.png';document[_0x5d0020(0x165)]('productImage')['src']=_0x3080ab,document['getElementById'](_0x5d0020(0x176))[_0x5d0020(0x171)]='#',_0x45b997[_0x5d0020(0x181)][_0x5d0020(0x168)]=_0x5d0020(0x1a1),_0x45b997['style'][_0x5d0020(0x19d)]='270px';}else{if(_0x556cac&&_0x556cac!==currentShortSku){const _0x3f77c0='https://fr.louisvuitton.com/images/is/image/lv/1/PP_VP_AS/louis-vuitton--'+_0x556cac+'_PM2_Front%20view.jpg?wid=800&amp;hei=800';document[_0x5d0020(0x165)]('productImage')['src']=_0x3f77c0,document['getElementById'](_0x5d0020(0x176))[_0x5d0020(0x171)]=_0x3f77c0,_0x45b997['style'][_0x5d0020(0x19d)]='270px',_0x45b997[_0x5d0020(0x181)][_0x5d0020(0x168)]=_0x5d0020(0x1a1),currentShortSku=_0x556cac;}else!_0x556cac&&!_0x46eace&&(_0x45b997['style'][_0x5d0020(0x168)]=_0x5d0020(0x192),currentShortSku='');}}let counter=0x0,serialOverride=![];function resetToDefaults(){const _0x1d558a=_0x3978d4;document['getElementById'](_0x1d558a(0x195))[_0x1d558a(0x178)]=_0x1d558a(0x198),document['getElementById'](_0x1d558a(0x1a7))['value']=_0x1d558a(0x197),document[_0x1d558a(0x165)](_0x1d558a(0x1a6))[_0x1d558a(0x178)]='US',document['getElementById']('supplierId')['value']=_0x1d558a(0x1af),document[_0x1d558a(0x165)](_0x1d558a(0x17a))[_0x1d558a(0x178)]='FR',document[_0x1d558a(0x165)]('originPref')['value']='UE',serialOverride=![],generateCode();}function clearAllFields(){const _0x317053=_0x3978d4;document['getElementById']('serial')[_0x317053(0x178)]='',document[_0x317053(0x165)]('shortSku')[_0x317053(0x178)]='',document['getElementById'](_0x317053(0x1a7))[_0x317053(0x178)]='',document[_0x317053(0x165)]('madeIn')['value']='',document[_0x317053(0x165)](_0x317053(0x1ac))[_0x317053(0x178)]='',document[_0x317053(0x165)](_0x317053(0x17a))[_0x317053(0x178)]='',document[_0x317053(0x165)](_0x317053(0x1ab))['value']='',serialOverride=![],generateCode();}function _0x1efd(){const _0x3fe998=['createElement','getDate','Error\x20generating\x20barcode:\x20','barcodeImage','getElementById','addEventListener','Copy\x20failed.\x20','display','getFullYear','248510uUjJON','padStart','catch','removeChild','44mXXLnW','random','ceil','href','select','getDay','toCanvas','onload','productImageLink','focus','value','#4CAF50','batch','6153427oQQtUb','9TadSrB','activeElement','backgroundColor','change','body','style','writeText','Copied!','innerText','serial','forEach','input','generatedCode','Copy\x20failed:','center','copy','canvas','hidden','#007bff','remove','setMonth','4123020JwuHOL','none','prototype','143685PYOFSs','shortSku','6lxpHqh','0010','M41414','htmlFor','24uwmzVP','getWeek','valueOf','top','hidden-label','90866eUTpsi','codeResult','block','innerHTML','appendChild','datamatrix','9458581zJzDPf','madeIn','quantity','click','getMonth','classList','originPref','supplierId','370241flbMkb','copyButton','130','label'];_0x1efd=function(){return _0x3fe998;};return _0x1efd();}function focusSerial(){const _0x40e8e7=_0x3978d4,_0x2afd6c=document[_0x40e8e7(0x165)]('serial');_0x2afd6c[_0x40e8e7(0x177)](),_0x2afd6c[_0x40e8e7(0x172)]();}function generateCode(){const _0x4713f0=_0x3978d4,_0x5d44d4=document[_0x4713f0(0x165)](_0x4713f0(0x185)),_0x454ad1=document['getElementById'](_0x4713f0(0x195)),_0x3e36ad=document['getElementById'](_0x4713f0(0x1a7)),_0x2668e9=document[_0x4713f0(0x165)]('madeIn'),_0x22da70=document[_0x4713f0(0x165)]('supplierId'),_0xb6e8aa=document[_0x4713f0(0x165)](_0x4713f0(0x17a)),_0x1941e4=document[_0x4713f0(0x165)](_0x4713f0(0x1ab));currentShortSku='',updateProductImage();if(!serialOverride){counter++;const _0x5a24f2=new Date(),_0x43f8c6=_0x5a24f2[_0x4713f0(0x169)](),_0x23a5b7=String(_0x5a24f2[_0x4713f0(0x1a9)]()+0x1)['padStart'](0x2,'0'),_0x4560c6=String(_0x5a24f2['getDate']())[_0x4713f0(0x16b)](0x2,'0'),_0xafaaf=''+_0x43f8c6+_0x23a5b7+_0x4560c6,_0x442994=String(counter)[_0x4713f0(0x16b)](0x4,'0'),_0x40d095='FR'+_0xafaaf+_0x442994;_0x5d44d4['value']=_0x40d095;}_0x5d44d4[_0x4713f0(0x166)](_0x4713f0(0x187),()=>{serialOverride=!![];});_0x5d44d4[_0x4713f0(0x178)]===''&&(_0x5d44d4['value']=createSerial());const _0x4d0162=document['querySelectorAll'](_0x4713f0(0x1b0));_0x4d0162[_0x4713f0(0x186)](_0x5b63b5=>{const _0x5041d6=_0x4713f0;_0x5b63b5[_0x5041d6(0x199)]!==_0x5041d6(0x185)&&_0x5b63b5[_0x5041d6(0x1aa)]['remove'](_0x5041d6(0x19e));});const _0x54cc46=document['getElementById'](_0x4713f0(0x188));_0x54cc46[_0x4713f0(0x1aa)][_0x4713f0(0x18f)](_0x4713f0(0x18d));const _0x3c6af2=_0x3e36ad[_0x4713f0(0x178)],_0x3b2e0e=_0x454ad1[_0x4713f0(0x178)],_0x2928b3=_0x22da70['value'],_0x40e96c=_0x2668e9[_0x4713f0(0x178)],_0x45c86a=_0x1941e4[_0x4713f0(0x178)],_0x5387e6=_0xb6e8aa[_0x4713f0(0x178)],_0x57c382='0_'+_0x5d44d4[_0x4713f0(0x178)]+'_'+_0x3c6af2+'_'+_0x3b2e0e+'__'+_0x2928b3+'_'+_0x40e96c+'_'+_0x45c86a+'_'+_0x5387e6;document['getElementById'](_0x4713f0(0x1a0))[_0x4713f0(0x184)]=_0x57c382;const _0x47b149=document[_0x4713f0(0x165)](_0x4713f0(0x164));_0x47b149[_0x4713f0(0x1a2)]='';const _0x443e0d=document['createElement'](_0x4713f0(0x18c));_0x47b149[_0x4713f0(0x1a3)](_0x443e0d);try{bwipjs[_0x4713f0(0x174)](_0x443e0d,{'bcid':_0x4713f0(0x1a4),'text':_0x57c382,'scale':1.5,'height':0x19,'includetext':![],'textxalign':_0x4713f0(0x18a)});}catch(_0x2f9a2f){_0x47b149[_0x4713f0(0x1a2)]=_0x4713f0(0x1b3)+_0x2f9a2f;}}window[_0x3978d4(0x175)]=function(){const _0x1c7020=_0x3978d4,_0x2aa948=document[_0x1c7020(0x165)](_0x1c7020(0x185)),_0x20b021=document[_0x1c7020(0x165)](_0x1c7020(0x195)),_0x3c7af6=document[_0x1c7020(0x165)](_0x1c7020(0x1a7)),_0x293398=document['getElementById'](_0x1c7020(0x1a6)),_0x3c1a36=document[_0x1c7020(0x165)](_0x1c7020(0x1ac)),_0x37b190=document[_0x1c7020(0x165)](_0x1c7020(0x17a)),_0x2f008a=document[_0x1c7020(0x165)](_0x1c7020(0x1ab));updateProductImage(),document[_0x1c7020(0x165)](_0x1c7020(0x195))[_0x1c7020(0x166)](_0x1c7020(0x17f),function(){const _0x26dd51=_0x1c7020;(!document[_0x26dd51(0x17d)]||document[_0x26dd51(0x17d)]['id']!==_0x26dd51(0x195))&&updateProductImage();}),_0x20b021[_0x1c7020(0x178)]=_0x1c7020(0x198),_0x3c7af6[_0x1c7020(0x178)]='0010',_0x293398[_0x1c7020(0x178)]='US',_0x3c1a36[_0x1c7020(0x178)]=_0x1c7020(0x1af),_0x37b190[_0x1c7020(0x178)]='FR',_0x2f008a[_0x1c7020(0x178)]='UE',generateCode();},document[_0x3978d4(0x165)](_0x3978d4(0x1ae))[_0x3978d4(0x166)](_0x3978d4(0x1a8),function(){const _0x1187e6=_0x3978d4,_0x2f9ce2=document[_0x1187e6(0x165)](_0x1187e6(0x1a0))[_0x1187e6(0x184)];if(navigator['clipboard'])navigator['clipboard'][_0x1187e6(0x182)](_0x2f9ce2)['then'](()=>{const _0x1b58be=_0x1187e6,_0x18a64e=this[_0x1b58be(0x184)];this['innerText']=_0x1b58be(0x183),this[_0x1b58be(0x181)][_0x1b58be(0x17e)]=_0x1b58be(0x179),setTimeout(()=>{const _0x4ba4ad=_0x1b58be;this['innerText']=_0x18a64e,this[_0x4ba4ad(0x181)]['backgroundColor']='#007bff';},0x5dc);})[_0x1187e6(0x16c)](_0xdbb820=>{const _0x4686f8=_0x1187e6;console['error'](_0x4686f8(0x189),_0xdbb820),alert(_0x4686f8(0x167)+_0xdbb820);});else{const _0x5cea6f=document[_0x1187e6(0x1b1)]('textarea');_0x5cea6f[_0x1187e6(0x178)]=_0x2f9ce2,document[_0x1187e6(0x180)]['appendChild'](_0x5cea6f),_0x5cea6f[_0x1187e6(0x172)]();try{document['execCommand'](_0x1187e6(0x18b));const _0x5612d3=this[_0x1187e6(0x184)];this['innerText']=_0x1187e6(0x183),this[_0x1187e6(0x181)][_0x1187e6(0x17e)]='#4CAF50',setTimeout(()=>{const _0x50ddea=_0x1187e6;this[_0x50ddea(0x184)]=_0x5612d3,this['style']['backgroundColor']=_0x50ddea(0x18e);},0x5dc);}catch(_0x3a8300){console['error'](_0x1187e6(0x189),_0x3a8300),alert('Copy\x20failed');}document['body'][_0x1187e6(0x16d)](_0x5cea6f);}});
</script>

</body>
</html>
